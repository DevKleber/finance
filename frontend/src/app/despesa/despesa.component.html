<div class="menu">

	<div class="row">
		<!-- <div class="col-md-12">
			Larçar
		</div> -->
		<div class="col-md-4 text-center compartilhada">
			<div class=" padding-15 cursor-pointer card shadow"
				[ngClass]="{'bg-gradient-primary text-white': despesaCompartilhada}"
				(click)="oqueLancar('Despesa compartilhada','dc')">
				Despesa compartilhada
			</div>
		</div>
		<div class="col-md-4 text-center cartao">
			<div class=" padding-15 cursor-pointer card shadow"
				[ngClass]="{'bg-gradient-primary text-white': despesaCartaoCredito}"
				(click)="oqueLancar('Despesa em cartão de crédito','dcc')">
				Despesa em cartão de crédito
			</div>
		</div>
		<div class="col-md-4 text-center conta">
			<div class=" padding-15 cursor-pointer card shadow"
				[ngClass]="{'bg-gradient-primary text-white': despesaConta}"
				(click)="oqueLancar('Despesa em conta','dct')">
				Despesa em conta
			</div>
		</div>
	</div>
</div>

<div class='row despesa card shadow' *ngIf="despesaCompartilhada">
	<form [formGroup]='form' novalidate>
		<div class='box-body'>

			<div class='form-group is-empty col-md-4'>
				<app-input-container errorMessage='Campo obrigatório' label='vl_despesac'>
					<input class='form-control' formControlName='vl_despesac' placeholder=''>
				</app-input-container>
			</div>

			<div class='form-group is-empty col-md-4'>
				<app-input-container errorMessage='Campo obrigatório' label='dt_despesa'>
					<input class='form-control' formControlName='dt_despesa' placeholder=''>
				</app-input-container>
			</div>

			<div class='form-group is-empty col-md-4'>
				<app-input-container errorMessage='Campo obrigatório' label='ds_despesa'>
					<input class='form-control' formControlName='ds_despesa' placeholder=''>
				</app-input-container>
			</div>

			<div class='form-group is-empty col-md-4'>
				<app-input-container errorMessage='Campo obrigatório' label='bo_dividir_amigos'>
					<input class='form-control' formControlName='bo_dividir_amigos' placeholder=''>
				</app-input-container>
			</div>

			<div class='form-group is-empty col-md-4'>
				<app-input-container errorMessage='Campo obrigatório' label='id_tipo_despesa'>
					<input class='form-control' formControlName='id_tipo_despesa' placeholder=''>
				</app-input-container>
			</div>

			<div class='form-group is-empty col-md-4'>
				<app-input-container errorMessage='Campo obrigatório' label='id_categoria_despesa'>
					<input class='form-control' formControlName='id_categoria_despesa' placeholder=''>
				</app-input-container>
			</div>

			<div class='form-group is-empty col-md-4'>
				<app-input-container errorMessage='Campo obrigatório' label='id_usuario'>
					<input class='form-control' formControlName='id_usuario' placeholder=''>
				</app-input-container>
			</div>

		</div>
		<!-- /.box-body -->

		<div class='box-footer col-md-12'>
			<button (click)='save(form.value)' [disabled]='!form.valid' class='btn btn-primary'>Salvar</button>
		</div>
	</form>
</div>
<div class="row">
	<div class="col-md-3"></div>
	<div class=' despesa card shadow col-md-6 ' *ngIf="despesaCartaoCredito">
		<form [formGroup]='formCartaoCredito' novalidate>

			<div class='row'>
				<div class='form-group is-empty col-md-4'>
					<app-input-container errorMessage='Campo obrigatório' label='Cartão de crédito'>
						<ng-select [items]="cartoes" bindLabel="no_cartao_credito" bindValue="id_cartao_credito"
							formControlName='id_cartao_credito'>
						</ng-select>
					</app-input-container>

				</div>
				<div class='form-group is-empty col-md-8'>

				</div>
				<div class='form-group is-empty col-md-12'>
					<app-input-container errorMessage='Campo obrigatório' label='Despesa'>
						<input class='form-control' formControlName='ds_despesa' placeholder=''>
					</app-input-container>
				</div>

				<div class='form-group is-empty col-md-4'>
					<app-input-container errorMessage='Campo obrigatório' label='Valor'>
						<input class='form-control' formControlName='vl_despesac' placeholder='' (change)="setValorRemanescente(0)">
					</app-input-container>
				</div>

				<div class='form-group is-empty col-md-4'>
					<app-input-container errorMessage='Campo obrigatório' label='Data da compra'>
						<input class='form-control' formControlName='dt_despesa' placeholder=''>
					</app-input-container>
				</div>

				<div class='form-group is-empty col-md-4 selectDespesa'>
					<app-input-container errorMessage='Campo obrigatório' label='Categoria'>
						<ng-select [items]="categorias" bindLabel="no_categoria_despesa"
							bindValue="id_categoria_despesa" groupBy="pai" formControlName='id_categoria_despesa'>
							<ng-template ng-optgroup-tmp let-item="item">
								{{item.pai}}
							</ng-template>
							<ng-template ng-label-tmp let-item="item">
								<i class="{{item.icon}}"></i>
								{{item.no_categoria_despesa}}
							</ng-template>

							<ng-template ng-option-tmp let-item="item" let-index="index" let-search="searchTerm">
								<i class="{{item.icon}}"></i>
								{{item.no_categoria_despesa}}
							</ng-template>
						</ng-select>

					</app-input-container>
				</div>


				<div class='form-group is-empty col-md-4'>
					<app-input-container errorMessage='Campo obrigatório' label='Tipo'>
						<ng-select [items]="tiposDespesa" bindLabel="no_tipo_despesa" bindValue="id_tipo_despesa"
							formControlName='id_tipo_despesa'>
						</ng-select>
					</app-input-container>
				</div>

				<div class='form-group is-empty col-md-3' *ngIf="formCartaoCredito.value.id_tipo_despesa == 2">
					<app-input-container errorMessage='Campo obrigatório' label='Quantas vezes'>
						<input type="number" class='form-control' formControlName='qtd_parcelas' placeholder=''>
					</app-input-container>
				</div>
			</div>

			<hr>

			<div class="row">
				<div class='form-group is-empty col-md-12'>
					<app-input-container errorMessage='Campo obrigatório' label='Dividir com amigo'>
						<div class="onoffswitch">
							<input type="checkbox" formControlName='bo_dividir_amigos' class="onoffswitch-checkbox"
								id="myonoffswitch2" checked>
							<label class="onoffswitch-label" for="myonoffswitch2"></label>
						</div>
					</app-input-container>

					<div class="row">
						<!-- voce -->
						<!-- <pre>{{ formCartaoCredito.value | json }}</pre> -->
						<!-- <div class="col-md-3" style="padding-bottom: 1.5rem"
							*ngIf="formCartaoCredito.value.bo_dividir_amigos">
							<div class="card-1">
								<img src="/assets/img/profile-photos/{{ item | helpers: 'random' }}.png" alt="Avatar"
									style="width:100%;border-radius: 50%;">
								<div class="">
									<h5 class="text-center"><b>VOCÊ</b></h5>
									<div class="form-group">
										<label for="formControlRange">Valor à pagar</label>
										<input type="range" class="form-control-range" id="formControlRange" min="0"
											max="100" style="padding: 0;" value="100">
									</div>
									<div class="valorAPagar">
										R$ {{formCartaoCredito.value.vl_despesac}}
									</div>
								</div>
							</div>
						</div> -->
						<ng-container *ngIf="formCartaoCredito.value.bo_dividir_amigos" >
							<div class="col-md-3" style="padding-bottom: 1.5rem"
								*ngFor="let itemDividir of formCartaoCredito.get('dividirPessoas').controls; let j = index; ">

								<div [formGroup]="itemDividir">
									<div class="card-1">
										<img src="/assets/img/profile-photos/{{ itemDividir | helpers: 'random' }}.png"
											alt="Avatar" style="width:100%;border-radius: 50%;">
										<div class="">
											<h5 class="text-center"><b>{{ itemDividir.value.no_pessoa }}</b></h5>
											<p>{{ itemDividir.value.email }}</p>
											<div class="form-group">
												<label for="formControlRange">Valor à pagar</label>
												<input type="range" class='form-control-range' formControlName="valor" (change)="mudandoValorParaCada(itemDividir,j)"
													placeholder="" min="0" max="{{formCartaoCredito.value.vl_despesac}}"
													style="padding: 0;" value="0">
											</div>
											<div class="valorAPagar">
												R$ {{itemDividir.value.valor}}
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="col-md-3">
								<button class="btn btnEscolherAmigo border" data-toggle="modal"
									data-target="#escolherAmigosDividirModal">Escolher amigo</button>

							</div>
							<div class="col-md-12">
								Valor remanescente: {{valorRemanescente}}
							</div>
						</ng-container>
					</div>
				</div>
			</div>


		</form>

	</div>
</div>

<div class='row despesa card shadow' *ngIf="despesaConta">
	<form [formGroup]='form' novalidate>
		<div class='box-body'>

			<div class='form-group is-empty col-md-4'>
				<app-input-container errorMessage='Campo obrigatório' label='vl_despesac'>
					<input class='form-control' formControlName='vl_despesac' placeholder=''>
				</app-input-container>
			</div>

			<div class='form-group is-empty col-md-4'>
				<app-input-container errorMessage='Campo obrigatório' label='dt_despesa'>
					<input class='form-control' formControlName='dt_despesa' placeholder=''>
				</app-input-container>
			</div>

			<div class='form-group is-empty col-md-4'>
				<app-input-container errorMessage='Campo obrigatório' label='ds_despesa'>
					<input class='form-control' formControlName='ds_despesa' placeholder=''>
				</app-input-container>
			</div>

			<div class='form-group is-empty col-md-4'>
				<app-input-container errorMessage='Campo obrigatório' label='bo_dividir_amigos'>
					<input class='form-control' formControlName='bo_dividir_amigos' placeholder=''>
				</app-input-container>
			</div>

			<div class='form-group is-empty col-md-4'>
				<app-input-container errorMessage='Campo obrigatório' label='id_tipo_despesa'>
					<input class='form-control' formControlName='id_tipo_despesa' placeholder=''>
				</app-input-container>
			</div>

			<div class='form-group is-empty col-md-4'>
				<app-input-container errorMessage='Campo obrigatório' label='id_categoria_despesa'>
					<input class='form-control' formControlName='id_categoria_despesa' placeholder=''>
				</app-input-container>
			</div>

			<div class='form-group is-empty col-md-4'>
				<app-input-container errorMessage='Campo obrigatório' label='id_usuario'>
					<input class='form-control' formControlName='id_usuario' placeholder=''>
				</app-input-container>
			</div>

		</div>
		<!-- /.box-body -->

		<div class='box-footer col-md-12'>
			<button (click)='save(form.value)' [disabled]='!form.valid' class='btn btn-primary'>Salvar</button>
		</div>
	</form>
</div>


<div class="modal fade" id="escolherAmigosDividirModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
	aria-hidden="true">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">
					Escolha amigos para dividir a conta
				</h5>
				<button class="close" type="button" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">×</span>
				</button>
			</div>
			<div class="modal-body">
				<!-- MODAL ESCOLHER AMIGO PARA DIVIDIR A CONTA -->
				<!-- escolher amigo para dividir -->
				<div class="row" *ngIf="formCartaoCredito.value.bo_dividir_amigos">
					<!-- input -->
					<div class="col-md-3"></div>
					<div class="input-group col-md-6">
						<input type="text" class="form-control bg-light border-0 small" placeholder="Nome"
							aria-label="Search" aria-describedby="basic-addon2" [(ngModel)]="nomePessoaModel" />
						<div class="input-group-append">
							<button class="btn btn-primary" type="button" (click)="procurarPessoa()">
								<i class="fas fa-search fa-sm"></i>
							</button>
						</div>
						<!-- input -->
					</div>

					<div class="col-md-12 margin-top-15">

						<h3 *ngIf="pessoas?.length">
							Resultados
							<a href="#" class="btn btn-primary btn-circle btn-sm">
								{{ pessoas?.length }}
							</a>
						</h3>
						<div *ngIf="fimCarregamentoProcurarPessoa">
							{{ fimCarregamentoProcurarPessoa }}:
							<b>{{ nomePessoaModel }}</b>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-3" style="padding-bottom: 1.5rem" *ngFor="let item of pessoas">

						<div class="card-1">
							<img src="/assets/img/profile-photos/{{ item | helpers: 'random' }}.png" alt="Avatar"
								style="width:100%;border-radius: 50%;">
							<div class="">
								<h5 class="text-center"><b>{{ item.no_pessoa }}</b></h5>
								<p>{{ item.email }}</p>
								<button class="btn w-100 border" (click)="dividirComAmigo(item)">
									Dividir conta com amigo
								</button>
							</div>
						</div>
					</div>
				</div>

				<!-- fim escolher amigo para dividir -->
			</div>

		</div>
	</div>
</div>
